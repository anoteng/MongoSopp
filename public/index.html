<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Soppsakkyndigpr√∏ve</title>
    <link rel="stylesheet" href="/css/main.css">
</head>
<body>
    <h1> May Node and Express be with you. </h1>
<p>Lorem ipsum</p>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script>
        function handleCredentialResponse(response) {
            console.log("Encoded JWT ID token: " + response.credential);
            const data = {
                credential: response.credential
            }
            var xhr = new XMLHttpRequest();
            xhr.open('POST', 'login');
            xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
            xhr.onload = function() {
                console.log('Signed in as: ' + xhr.responseText);
            };
            xhr.send('idtoken=' + response.credential);
            // fetch('login', {
            //     method: 'POST',
            //     headers: {
            //         'Content-Type': 'application/json',
            //     },
            //     body: JSON.stringify(data),
            // })
            // .then(res => res.json())
            // .then(res => {
            //     window.localStorage.setItem('X-API-KEY', res)
            // })
            // .catch(error => {alert(error)})
        }
        window.onload = function () {
            google.accounts.id.initialize({
                client_id: "620486776402-qg81g7o1vub6n35s3s6nk4911va2vpsm.apps.googleusercontent.com",
                callback: handleCredentialResponse
            });
            google.accounts.id.renderButton(
                document.getElementById("buttonDiv"),
                { theme: "outline", size: "large" }  // customization attributes
            );
            // google.accounts.id.prompt(); // also display the One Tap dialog
        }
    </script>
    <div id="buttonDiv"></div>
    </div>
<!--<p><div id="my-signin2"></div>-->
<!--    <script>-->
<!--        function onSuccess(googleUser) {-->
<!--            console.log('Logged in as: ' + googleUser.getBasicProfile().getName());-->
<!--            const id_token = googleUser.getAuthResponse().id_token;-->
<!--            var xhr = new XMLHttpRequest();-->
<!--            xhr.open('POST', 'login');-->
<!--            xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');-->
<!--            xhr.onload = function() {-->
<!--                console.log('Signed in as: ' + xhr.responseText);-->
<!--            };-->
<!--            xhr.send('idtoken=' + id_token);-->
<!--        }-->
<!--        function onFailure(error) {-->
<!--            console.log(error);-->
<!--        }-->
<!--        function renderButton() {-->
<!--            gapi.signin2.render('my-signin2', {-->
<!--                'scope': 'profile email',-->
<!--                'width': 240,-->
<!--                'height': 50,-->
<!--                'longtitle': true,-->
<!--                'theme': 'dark',-->
<!--                'onsuccess': onSuccess,-->
<!--                'onfailure': onFailure-->
<!--            });-->
<!--        }-->
<!--    </script>-->

<!--    <script src="https://apis.google.com/js/platform.js?onload=renderButton" async defer></script></p>-->
</body>
</html>